ç®€å•ä»‹ç»ç”¨Matlabæ±‚è§£å¾®åˆ†æ–¹ç¨‹

### æœ‰å…³æ¦‚å¿µ

**å¸¸å¾®åˆ†æ–¹ç¨‹(ODE)**ï¼šåªæ¶‰åŠä¸€ä¸ªè‡ªå˜é‡åŠå…¶å¯¼æ•°çš„æ–¹ç¨‹

**åå¾®åˆ†æ–¹ç¨‹(PDE)**ï¼šè®¾è®¡å¤šä¸ªè‡ªå˜é‡åŠå…¶åå¯¼æ•°çš„æ–¹ç¨‹

**é˜¶æ•°**ï¼šå¾®åˆ†æ–¹ç¨‹çš„é˜¶æ•°æ˜¯æ–¹ç¨‹ä¸­æœ€é«˜å¯¼æ•°çš„é˜¶æ•°ã€‚ä¾‹å¦‚${y}''+{y}'+y=0$æ˜¯äºŒé˜¶å¸¸å¾®åˆ†æ–¹ç¨‹

**ç¬¦å·è§£**ï¼šå½¢å¼ä¸ºä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œå¦‚$y=x^{2}+e^{x}$

**æ•°å€¼è§£**ï¼šå½¢å¼ä¸ºä¸€ä¸ªæ•°å€¼ï¼Œå¦‚$y(0)=4.3423$

**çº¿æ€§å¾®åˆ†æ–¹ç¨‹**ï¼šæ‰€æœ‰é¡¹éƒ½æ˜¯å…³äºæœªçŸ¥å‡½æ•°åŠå…¶å¯¼æ•°çš„çº¿æ€§ç»„åˆ

**éçº¿æ€§å¾®åˆ†æ–¹ç¨‹**ï¼šè‡³å°‘æœ‰ä¸€é¡¹æ˜¯éçº¿æ€§å½¢å¼

**åˆå€¼é—®é¢˜(IVP)**ï¼šç»™å®šå‡½æ•°åœ¨æŸä¸€ç‚¹çš„å€¼åŠå…¶å¯¼æ•°å€¼ï¼Œæ±‚å¾®åˆ†æ–¹ç¨‹çš„è§£

**è¾¹å€¼é—®é¢˜(BVP)**ï¼šç»™å®šåœ¨åŒºé—´ä¸¤ç«¯çš„å‡½æ•°å€¼ï¼Œæ±‚è§£æ»¡è¶³è¿™äº›è¾¹ç•Œæ¡ä»¶çš„å¾®åˆ†æ–¹ç¨‹è§£

***æ³¨ï¼šå¯¹äºå¸¸å¾®åˆ†æ–¹ç¨‹ï¼Œåªæœ‰ä¸€å°éƒ¨åˆ†å¯ä»¥æ±‚å¾—è§£æè§£ï¼Œå¤§éƒ¨åˆ†å¸¸å¾®åˆ†æ–¹ç¨‹æ— æ³•æ±‚å¾—è§£æè§£ï¼Œåªèƒ½æ±‚å¾—æ•°å€¼è§£ã€‚Matlabæ— æ³•ç›´æ¥æ±‚è§£é«˜é˜¶å¾®åˆ†æ–¹ç¨‹æˆ–å¾®åˆ†æ–¹ç¨‹ç»„çš„æ•°å€¼è§£ï¼Œå¿…é¡»åŒ–æˆä¸€é˜¶å¾®åˆ†æ–¹ç¨‹ç»„æ‰èƒ½æ±‚æ•°å€¼è§£***

### æ±‚å¸¸å¾®åˆ†æ–¹ç¨‹çš„ç¬¦å·è§£

$$\frac{\mathrm{d} y}{\mathrm{d} x}+3y=8,y|_{x=0}=2$$

```matlab
clear,clc				    %æ¸…é™¤å˜é‡ï¼Œæ¸…ç†å·¥ä½œåŒº
syms y(x)				    %å®šä¹‰è¦æ±‚è§£çš„å˜é‡
dy=diff(y)				    %yçš„ä¸€é˜¶å¯¼
y=dsolve(dy+3*y==8,y(0)==2) %æ±‚è§£æ–¹ç¨‹
```

è§£å¾—ç»“æœä¸º
$$y=\frac{8}{3}-\frac{2\,{\mathrm{e}}^{-3\,x}}{3}$$

æ±‚è§£ä¸‹åˆ—æ–¹ç¨‹ç»„
$$
\left
\{\begin{matrix}
 2\frac{\mathrm{d} x}{\mathrm{d} t}+4x+\frac{\mathrm{d} y}{\mathrm{d} t}-y=e^{t},x|_{t=0}=\frac{3}{2} 
 &\\\frac{\mathrm{d} x}{\mathrm{d} t}+3x+y=0,y|_{t=0}=0
\end{matrix}
\right.
$$â€‹


æ±‚è§£ä»£ç å¦‚ä¸‹


```
clear,clc;
syms y(t)
dy=diff(y)
```
æ±‚è§£å¸¸å¾®åˆ†æ–¹ç¨‹ç»„
è¯•æ±‚è§£ä¸‹åˆ—æŸ¯è¥¿é—®é¢˜

$$
\left
\{\begin{matrix}
  \frac{\mathrm{d} x}{\mathrm{d} t}=Ax
  \\ x(0)=[x_{1}(t),x_{2}(t),x_{3}(t)]^{T}
\end{matrix}\right.$$

<div>
$$
A=\begin{bmatrix}
  3\quad -1\quad 1
    \\2\quad 0\quad -1
    \\1\quad -1\quad 0
\end{bmatrix}
$$
</div>

æ±‚è§£ä»£ç å¦‚ä¸‹
```
clear,clc;
syms x(t) [3,1];
A=[3 -1 1;2 0 -1;1 -1 2];
[s1,s2,s3]=dsolve(diff(x)==A*x,x(0)==[1 1 1]);
```


### æ±‚å¸¸å¾®åˆ†æ–¹ç¨‹çš„æ•°å€¼è§£

Matlabä¸­æä¾›äº†å¤šä¸ªè§£å¸¸å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£çš„å‡½æ•°ï¼Œode45ï¼Œode23ç­‰ï¼Œè¿™äº›å‡½æ•°çš„åŒºåˆ«å¯ä»¥å‚è€ƒMatlabå®˜ç½‘ç»™å‡ºçš„è¡¨æ ¼

#### åˆå€¼é—®é¢˜
æ±‚å¾®åˆ†æ–¹ç¨‹ç»„çš„æ•°å€¼è§£ï¼Œå¹¶ä¸”ç”»å‡ºx(t),y(t)è§£æ›²çº¿å›¾å½¢

$$
\left\{\begin{matrix}
  {x}'=-x^3-y,x(0)=1\\
  {y}'=x-y^3,y(0)=0.5
\end{matrix}\right.
0\le t \le 30 
$$


æ±‚è§£ä»£ç å¦‚ä¸‹

```
clear,clc;
close all
eq=@(t,z)[-z(1)^3-z(2);z(1)-z(2)^3];
s=ode45(eq,[0,30],[1;0.5])
%subplotç”¨äºåˆ›å»ºå­çª—å›¾
subplot(121),fplot(@(t)deval(s,t,1),[0,30],'--','LineWidth',1.5);
hold on
fplot(@(t)deval(s,t,2),[0,30],'LineWidth',1.5)
legend('$x(t)$','$y(t)$','Location','best','Interpreter','Latex')
xlabel('$t$','Interpreter','latex');
subplot(122),fplot(@(t)deval(s,t,1),[0,30],'k')
xlabel('$x$','Interpreter','latex');
ylabel('$y$','Interpreter','latex','Rotation',0)
```

è§£æ›²çº¿å›¾å½¢å¦‚ä¸‹
<img src="http://image.slugyao.top/untitled.png" width=500>



#### è¾¹å€¼é—®é¢˜
åœ¨Matlabä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨bvp4cå’Œbvpinitæ¥æ±‚è§£å¸¸å¾®åˆ†æ–¹ç¨‹çš„ä¸¤ç‚¹è¾¹å€¼é—®é¢˜
è¾¹å€¼é—®é¢˜çš„æ±‚è§£éœ€è¦çŒœæµ‹è§£
bvp4cçš„è°ƒç”¨æ ¼å¼å¦‚ä¸‹

```
sol=bvp4c(@odefun,@bcfun,solinit,options,p1,p2,...);
```

å…¶ä¸­solinitæ˜¯åˆå§‹çŒœæµ‹ç»“æ„ï¼Œsol.xæ˜¯åˆå§‹çŒœæµ‹å€¼

æ±‚è§£å¾®åˆ†æ–¹ç¨‹ç»„
$$
\left\{\begin{matrix}
   {u}'=0.5u(w-u)/v\\
    {v}'=-0.5(w-u),\\
   {w}'=(0.9-1000(w-y))-0.5w(w-u)/z\\
    {z}'=0.5(w-u)\\
   {y}'=-100(y-w)
\end{matrix}\right.
$$

è¾¹ç•Œæ¡ä»¶ä¸º$$u(0)=v(0)=w(0)=1;z(0)=-10;w(1)=y(1)$$

ä½¿ç”¨ä»¥ä¸‹çŒœæµ‹è§£

$$
\left\{\begin{matrix}
  u(x)=1\\
   v(x)=-0.5(w-u),\\
   w(x)=-4.5x^2+8.91x+1\\
   z(x)=-10\\
  y(x)=-4.5x^2+9x+0.91
\end{matrix}\right.
$$


ä»£ç å¦‚ä¸‹
```
clear,clc;
%eqæ˜¯æ–¹ç¨‹çš„åŒ¿åå‡½æ•°å…¶ä¸­y(1)~y(5)åˆ†åˆ«ä»£è¡¨é¢˜ç›®ä¸­çš„u,v,w,z,y
eq=@(x,y)[0.5*y(1)*(y(3)-y(1))/y(2)
-0.5*(y(3)-y(1))
(0.9-1000*(y(3)-y(5))-0.5*y(3)*(y(3)-y(1)))/y(4)
0.5*(y(3)-y(1))
-100*(y(5)-y(3))];
%bdæ˜¯çŒœæµ‹è§£çš„åŒ¿åå‡½æ•°
bd=@(ya,yb)[ya(1)=1;ya(2)-1;ya(3)-1;ya(4)+10;yb(3)-yb(5)];
guess=@(x)[1;1;-4.5*x.^2+8.91*x+1;-10;-4.5*x.^2+9*x+0.91]; 
%ç»™å‡ºåˆå§‹çŒœæµ‹è§£çš„ç»“æ„
guess_structure=bvpinit(linspace(0,1,5),guess); 
sol=bvp4c(eq,bd,guess_structure);
plot(sol.x,sol.y(1,:),'-*',sol.x,sol.y(2,:),'-D',sol.x,sol.y(3,:),':S',...
    sol.x,sol.y(4,:),'-.O',sol.x,sol.y(5,:),'--P') 
legend({'$u$','$v$','$w$','$z$','$y$'}, 'Interpreter', 'latex',... 'Location','southwest') 

```

è§£æ›²çº¿çš„å›¾åƒå¦‚ä¸‹

<img src="http://image.slugyao.top/617.png" width=500>

æœ€åï¼Œè¿™ç‰‡æ–‡ç« é‡Œé¢çš„æ–¹ç¨‹å¼æ’ç‰ˆä¸æ˜¯å¾ˆç¾è§‚ï¼Œæˆ‘è¿˜åœ¨å­¦ä¹ Latexï¼Œè§è°…ğŸ˜¥